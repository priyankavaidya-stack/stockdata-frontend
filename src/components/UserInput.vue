<template>
  <div class="title-container">
    <h1 class="title">{{ msg }}</h1>
  </div>
  <div class="container">
    <div class="box">
        <div class="input-box">
            <input class="symbol-input" v-model="symbol" type="text" placeholder="Enter symbol name..." />
            <p class="error-msg" v-if="errorMessage">{{ errorMessage }}</p>
        </div>
        <section class="dropdown-wrapper">
            <select v-model="selectedPeriod">
                <option value="daily">Daily</option>
                <option value="hourly">Hourly</option>
            </select>
        </section>
    </div>
    
    <button 
      @click="fetchData" 
      class="fetch-btn"  
      :style="{ backgroundColor: isDisabled ? '#4CAF50' : '#006400',  opacity: isDisabled ? 0.6 : 1, cursor: isDisabled ?  'not-allowed' : 'pointer' }" 
      :disabled="isDisabled">
      Fetch Data
    </button>
    
    <!-- Loader -->
    <div v-if="loading" class="loader"></div>

    <!-- Display fetched data here -->
    <div class="chart" id="container" ref="chartContainer" v-if="showChart" style="width: 100% ; height: 400px;"></div>
  </div>

</template>

<script>
import { createChart } from 'lightweight-charts';

export default {
    name: 'HelloWorld',
    props: {
        msg: String
    },
    data() {
        return {
        symbol: '',
        selectedPeriod: 'daily',
        errorMessage: '',
        flagValue: false,
        isDisabled: false,
        isZoomed: false,
        showChart: true,
        loading: false,
        responseData: null,
        error: null
        };
    },
    watch: {
    symbol: {
    //   immediate: true,
      handler() {
        // this.flagValue = true;
        this.checkEmpty();
      },
    },
    selectedPeriod: {
    //   immediate: true,
      handler() {
        // this.flagValue = true;
        this.checkEmpty();
      },
    }
    },
    methods: {
        checkEmpty() {
            if (this.symbol) {
                this.isDisabled = false;
                this.errorMessage = '';
            } else {
                this.isDisabled = true;
                this.errorMessage = 'Please enter symbol';
            }
            this.clearChartContainer();
        },
        clearChartContainer() {
            
            const chartContainer = document.getElementById('container');

            while (chartContainer.firstChild) {
                chartContainer.removeChild(chartContainer.lastChild);
            }
        },
        fetchData() {
            this.checkEmpty();

            if (!this.isDisabled){

                // Clear the chart container before rendering the new chart
                this.clearChartContainer(); 

                this.loading = true;

                const url = `http://localhost:8081/api/search?symbol=${this.symbol}&period=${this.selectedPeriod}`;

                fetch(url)
                    .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                    })
                    .then(data => {

                        this.loading = false;

                        console.log(data);

                        // Handle the received data
                        let timeSeriesData;
                        // let timeSeriesData ={
                        // "2023-10-20": {
                        //     "1. open": "138.1500",
                        //     "2. high": "139.2700",
                        //     "3. low": "137.1200",
                        //     "4. close": "137.1600",
                        //     "5. volume": "4865615"
                        // },
                        // "2023-10-19": {
                        //     "1. open": "138.6400",
                        //     "2. high": "139.4050",
                        //     "3. low": "137.9300",
                        //     "4. close": "138.0100",
                        //     "5. volume": "5314159"
                        // },
                        // "2023-10-18": {
                        //     "1. open": "140.0000",
                        //     "2. high": "140.4300",
                        //     "3. low": "139.5800",
                        //     "4. close": "139.9700",
                        //     "5. volume": "3329985"
                        // },
                        // "2023-10-17": {
                        //     "1. open": "137.1200",
                        //     "2. high": "140.6200",
                        //     "3. low": "136.3100",
                        //     "4. close": "140.3200",
                        //     "5. volume": "4172822"
                        // },
                        // "2023-10-16": {
                        //     "1. open": "139.2800",
                        //     "2. high": "139.7800",
                        //     "3. low": "138.5200",
                        //     "4. close": "139.2100",
                        //     "5. volume": "3361468"
                        // },
                        // "2023-10-13": {
                        //     "1. open": "139.7700",
                        //     "2. high": "140.1200",
                        //     "3. low": "138.2700",
                        //     "4. close": "138.4600",
                        //     "5. volume": "4583553"
                        // },
                        // "2023-10-12": {
                        //     "1. open": "142.5100",
                        //     "2. high": "142.9300",
                        //     "3. low": "140.9500",
                        //     "4. close": "141.2400",
                        //     "5. volume": "3921142"
                        // },
                        // "2023-10-11": {
                        //     "1. open": "142.5100",
                        //     "2. high": "143.3400",
                        //     "3. low": "142.1400",
                        //     "4. close": "143.2300",
                        //     "5. volume": "2511459"
                        // },
                        // "2023-10-10": {
                        //     "1. open": "142.6000",
                        //     "2. high": "143.4150",
                        //     "3. low": "141.7200",
                        //     "4. close": "142.1100",
                        //     "5. volume": "3015784"
                        // },
                        // "2023-10-09": {
                        //     "1. open": "142.3000",
                        //     "2. high": "142.4000",
                        //     "3. low": "140.6800",
                        //     "4. close": "142.2000",
                        //     "5. volume": "2354396"
                        // },
                        // "2023-10-06": {
                        //     "1. open": "141.4000",
                        //     "2. high": "142.9400",
                        //     "3. low": "140.1100",
                        //     "4. close": "142.0300",
                        //     "5. volume": "3511347"
                        // },
                        // "2023-10-05": {
                        //     "1. open": "140.9000",
                        //     "2. high": "141.7000",
                        //     "3. low": "140.1900",
                        //     "4. close": "141.5200",
                        //     "5. volume": "3223910"
                        // },
                        // "2023-10-04": {
                        //     "1. open": "140.3700",
                        //     "2. high": "141.2004",
                        //     "3. low": "139.9900",
                        //     "4. close": "141.0700",
                        //     "5. volume": "2637779"
                        // },
                        // "2023-10-03": {
                        //     "1. open": "140.8700",
                        //     "2. high": "141.6400",
                        //     "3. low": "140.0000",
                        //     "4. close": "140.3900",
                        //     "5. volume": "3284421"
                        // },
                        // "2023-10-02": {
                        //     "1. open": "140.0400",
                        //     "2. high": "141.4500",
                        //     "3. low": "139.8600",
                        //     "4. close": "140.8000",
                        //     "5. volume": "3275461"
                        // },
                        // "2023-09-29": {
                        //     "1. open": "142.0000",
                        //     "2. high": "142.1300",
                        //     "3. low": "139.6100",
                        //     "4. close": "140.3000",
                        //     "5. volume": "5703983"
                        // },
                        // "2023-09-28": {
                        //     "1. open": "142.1400",
                        //     "2. high": "142.2820",
                        //     "3. low": "140.2050",
                        //     "4. close": "141.5800",
                        //     "5. volume": "5783422"
                        // },
                        // "2023-09-27": {
                        //     "1. open": "143.6700",
                        //     "2. high": "143.8200",
                        //     "3. low": "141.7600",
                        //     "4. close": "143.1700",
                        //     "5. volume": "4439121"
                        // },
                        // "2023-09-26": {
                        //     "1. open": "145.5100",
                        //     "2. high": "146.1700",
                        //     "3. low": "143.0201",
                        //     "4. close": "143.2400",
                        //     "5. volume": "4824654"
                        // },
                        // "2023-09-25": {
                        //     "1. open": "146.5700",
                        //     "2. high": "147.4300",
                        //     "3. low": "146.2500",
                        //     "4. close": "146.4800",
                        //     "5. volume": "2694245"
                        // },
                        // "2023-09-22": {
                        //     "1. open": "147.4100",
                        //     "2. high": "148.1000",
                        //     "3. low": "146.8200",
                        //     "4. close": "146.9100",
                        //     "5. volume": "2562216"
                        // },
                        // "2023-09-21": {
                        //     "1. open": "149.0000",
                        //     "2. high": "149.2500",
                        //     "3. low": "147.3100",
                        //     "4. close": "147.3800",
                        //     "5. volume": "4944786"
                        // },
                        // "2023-09-20": {
                        //     "1. open": "148.3600",
                        //     "2. high": "151.9299",
                        //     "3. low": "148.1300",
                        //     "4. close": "149.8300",
                        //     "5. volume": "9636681"
                        // },
                        // "2023-09-19": {
                        //     "1. open": "145.0000",
                        //     "2. high": "146.7200",
                        //     "3. low": "144.6600",
                        //     "4. close": "146.5200",
                        //     "5. volume": "3945423"
                        // },
                        // "2023-09-18": {
                        //     "1. open": "145.7700",
                        //     "2. high": "146.4800",
                        //     "3. low": "145.0600",
                        //     "4. close": "145.0900",
                        //     "5. volume": "2508062"
                        // },
                        // "2023-09-15": {
                        //     "1. open": "147.1100",
                        //     "2. high": "147.8500",
                        //     "3. low": "145.5300",
                        //     "4. close": "145.9900",
                        //     "5. volume": "6234033"
                        // },
                        // "2023-09-14": {
                        //     "1. open": "147.3800",
                        //     "2. high": "147.7300",
                        //     "3. low": "146.4800",
                        //     "4. close": "147.3500",
                        //     "5. volume": "2723200"
                        // },
                        // "2023-09-13": {
                        //     "1. open": "145.9500",
                        //     "2. high": "146.9800",
                        //     "3. low": "145.9200",
                        //     "4. close": "146.5500",
                        //     "5. volume": "2627999"
                        // },
                        // "2023-09-12": {
                        //     "1. open": "147.9200",
                        //     "2. high": "148.0000",
                        //     "3. low": "145.8000",
                        //     "4. close": "146.3000",
                        //     "5. volume": "4457695"
                        // },
                        // "2023-09-11": {
                        //     "1. open": "148.5700",
                        //     "2. high": "148.7800",
                        //     "3. low": "147.5800",
                        //     "4. close": "148.3800",
                        //     "5. volume": "3273720"
                        // },
                        // "2023-09-08": {
                        //     "1. open": "147.3500",
                        //     "2. high": "148.5900",
                        //     "3. low": "147.2600",
                        //     "4. close": "147.6800",
                        //     "5. volume": "3722927"
                        // },
                        // "2023-09-07": {
                        //     "1. open": "148.1300",
                        //     "2. high": "148.7800",
                        //     "3. low": "147.4000",
                        //     "4. close": "147.5200",
                        //     "5. volume": "3333040"
                        // },
                        // "2023-09-06": {
                        //     "1. open": "147.6600",
                        //     "2. high": "148.3300",
                        //     "3. low": "147.1200",
                        //     "4. close": "148.0600",
                        //     "5. volume": "2932203"
                        // },
                        // "2023-09-05": {
                        //     "1. open": "147.9100",
                        //     "2. high": "149.0000",
                        //     "3. low": "147.5719",
                        //     "4. close": "148.1300",
                        //     "5. volume": "3731281"
                        // },
                        // "2023-09-01": {
                        //     "1. open": "147.2600",
                        //     "2. high": "148.1000",
                        //     "3. low": "146.9200",
                        //     "4. close": "147.9400",
                        //     "5. volume": "2727796"
                        // },
                        // "2023-08-31": {
                        //     "1. open": "146.9400",
                        //     "2. high": "147.7275",
                        //     "3. low": "146.5400",
                        //     "4. close": "146.8300",
                        //     "5. volume": "3885949"
                        // },
                        // "2023-08-30": {
                        //     "1. open": "146.4200",
                        //     "2. high": "146.9200",
                        //     "3. low": "145.7452",
                        //     "4. close": "146.8600",
                        //     "5. volume": "2245402"
                        // },
                        // "2023-08-29": {
                        //     "1. open": "146.3000",
                        //     "2. high": "146.7300",
                        //     "3. low": "145.6200",
                        //     "4. close": "146.4500",
                        //     "5. volume": "2778113"
                        // },
                        // "2023-08-28": {
                        //     "1. open": "145.4100",
                        //     "2. high": "146.7400",
                        //     "3. low": "145.2100",
                        //     "4. close": "146.0200",
                        //     "5. volume": "3561347"
                        // },
                        // "2023-08-25": {
                        //     "1. open": "144.1800",
                        //     "2. high": "145.4700",
                        //     "3. low": "143.5000",
                        //     "4. close": "145.3500",
                        //     "5. volume": "3660147"
                        // },
                        // "2023-08-24": {
                        //     "1. open": "143.5050",
                        //     "2. high": "144.4700",
                        //     "3. low": "143.2200",
                        //     "4. close": "143.5500",
                        //     "5. volume": "2900244"
                        // },
                        // "2023-08-23": {
                        //     "1. open": "141.7200",
                        //     "2. high": "143.4750",
                        //     "3. low": "141.5800",
                        //     "4. close": "143.4100",
                        //     "5. volume": "2559083"
                        // },
                        // "2023-08-22": {
                        //     "1. open": "142.6600",
                        //     "2. high": "143.2250",
                        //     "3. low": "141.3000",
                        //     "4. close": "141.4900",
                        //     "5. volume": "3557734"
                        // },
                        // "2023-08-21": {
                        //     "1. open": "141.4200",
                        //     "2. high": "142.3900",
                        //     "3. low": "141.1100",
                        //     "4. close": "142.2800",
                        //     "5. volume": "2937781"
                        // },
                        // "2023-08-18": {
                        //     "1. open": "140.0000",
                        //     "2. high": "141.8300",
                        //     "3. low": "139.7600",
                        //     "4. close": "141.4100",
                        //     "5. volume": "3915480"
                        // },
                        // "2023-08-17": {
                        //     "1. open": "141.0100",
                        //     "2. high": "142.6600",
                        //     "3. low": "140.6000",
                        //     "4. close": "140.6600",
                        //     "5. volume": "3742058"
                        // },
                        // "2023-08-16": {
                        //     "1. open": "141.7000",
                        //     "2. high": "142.0900",
                        //     "3. low": "140.5600",
                        //     "4. close": "140.6400",
                        //     "5. volume": "3285347"
                        // },
                        // "2023-08-15": {
                        //     "1. open": "141.5000",
                        //     "2. high": "142.3100",
                        //     "3. low": "141.2000",
                        //     "4. close": "141.8700",
                        //     "5. volume": "3656559"
                        // },
                        // "2023-08-14": {
                        //     "1. open": "143.0500",
                        //     "2. high": "143.3650",
                        //     "3. low": "141.8020",
                        //     "4. close": "141.9100",
                        //     "5. volume": "4226563"
                        // },
                        // "2023-08-11": {
                        //     "1. open": "143.1200",
                        //     "2. high": "143.4500",
                        //     "3. low": "142.2050",
                        //     "4. close": "143.1200",
                        //     "5. volume": "2526433"
                        // },
                        // "2023-08-10": {
                        //     "1. open": "143.0400",
                        //     "2. high": "144.5800",
                        //     "3. low": "142.6900",
                        //     "4. close": "143.2500",
                        //     "5. volume": "4735763"
                        // },
                        // "2023-08-09": {
                        //     "1. open": "144.9400",
                        //     "2. high": "144.9400",
                        //     "3. low": "142.3000",
                        //     "4. close": "142.4900",
                        //     "5. volume": "4073038"
                        // },
                        // "2023-08-08": {
                        //     "1. open": "145.7000",
                        //     "2. high": "146.1500",
                        //     "3. low": "144.1100",
                        //     "4. close": "145.9100",
                        //     "5. volume": "4654582"
                        // },
                        // "2023-08-07": {
                        //     "1. open": "145.0000",
                        //     "2. high": "146.5000",
                        //     "3. low": "144.9300",
                        //     "4. close": "146.1800",
                        //     "5. volume": "3438654"
                        // },
                        // "2023-08-04": {
                        //     "1. open": "145.0900",
                        //     "2. high": "146.0900",
                        //     "3. low": "143.9900",
                        //     "4. close": "144.2400",
                        //     "5. volume": "4223204"
                        // },
                        // "2023-08-03": {
                        //     "1. open": "143.7800",
                        //     "2. high": "145.2200",
                        //     "3. low": "143.3116",
                        //     "4. close": "144.4500",
                        //     "5. volume": "3952640"
                        // },
                        // "2023-08-02": {
                        //     "1. open": "142.7800",
                        //     "2. high": "144.3000",
                        //     "3. low": "142.3100",
                        //     "4. close": "144.1700",
                        //     "5. volume": "4959381"
                        // },
                        // "2023-08-01": {
                        //     "1. open": "144.2500",
                        //     "2. high": "144.4800",
                        //     "3. low": "142.1700",
                        //     "4. close": "143.3300",
                        //     "5. volume": "4798703"
                        // },
                        // "2023-07-31": {
                        //     "1. open": "143.8100",
                        //     "2. high": "144.6050",
                        //     "3. low": "143.5300",
                        //     "4. close": "144.1800",
                        //     "5. volume": "6138902"
                        // },
                        // "2023-07-28": {
                        //     "1. open": "143.4400",
                        //     "2. high": "143.9500",
                        //     "3. low": "142.8500",
                        //     "4. close": "143.4500",
                        //     "5. volume": "6686627"
                        // },
                        // "2023-07-27": {
                        //     "1. open": "142.3000",
                        //     "2. high": "143.3800",
                        //     "3. low": "141.9000",
                        //     "4. close": "142.9700",
                        //     "5. volume": "6331563"
                        // },
                        // "2023-07-26": {
                        //     "1. open": "140.4400",
                        //     "2. high": "141.2500",
                        //     "3. low": "139.8800",
                        //     "4. close": "141.0700",
                        //     "5. volume": "4046441"
                        // },
                        // "2023-07-25": {
                        //     "1. open": "139.4200",
                        //     "2. high": "140.4300",
                        //     "3. low": "139.0403",
                        //     "4. close": "140.3300",
                        //     "5. volume": "3770813"
                        // },
                        // "2023-07-24": {
                        //     "1. open": "139.3500",
                        //     "2. high": "140.1200",
                        //     "3. low": "138.7788",
                        //     "4. close": "139.5400",
                        //     "5. volume": "3475442"
                        // },
                        // "2023-07-21": {
                        //     "1. open": "138.2100",
                        //     "2. high": "139.7799",
                        //     "3. low": "137.7600",
                        //     "4. close": "138.9400",
                        //     "5. volume": "5858741"
                        // },
                        // "2023-07-20": {
                        //     "1. open": "137.1900",
                        //     "2. high": "140.3200",
                        //     "3. low": "136.5600",
                        //     "4. close": "138.3800",
                        //     "5. volume": "10896330"
                        // },
                        // "2023-07-19": {
                        //     "1. open": "135.5300",
                        //     "2. high": "136.4500",
                        //     "3. low": "135.1900",
                        //     "4. close": "135.4800",
                        //     "5. volume": "5519992"
                        // },
                        // "2023-07-18": {
                        //     "1. open": "134.7100",
                        //     "2. high": "135.9500",
                        //     "3. low": "134.2900",
                        //     "4. close": "135.3600",
                        //     "5. volume": "3852058"
                        // },
                        // "2023-07-17": {
                        //     "1. open": "133.2600",
                        //     "2. high": "134.6100",
                        //     "3. low": "133.1000",
                        //     "4. close": "134.2400",
                        //     "5. volume": "3168419"
                        // },
                        // "2023-07-14": {
                        //     "1. open": "133.9100",
                        //     "2. high": "133.9200",
                        //     "3. low": "132.9400",
                        //     "4. close": "133.4000",
                        //     "5. volume": "2861496"
                        // },
                        // "2023-07-13": {
                        //     "1. open": "133.5100",
                        //     "2. high": "135.0700",
                        //     "3. low": "133.3600",
                        //     "4. close": "133.9200",
                        //     "5. volume": "3221422"
                        // },
                        // "2023-07-12": {
                        //     "1. open": "135.0700",
                        //     "2. high": "135.3300",
                        //     "3. low": "132.5750",
                        //     "4. close": "132.8400",
                        //     "5. volume": "3732189"
                        // },
                        // "2023-07-11": {
                        //     "1. open": "133.6600",
                        //     "2. high": "134.5600",
                        //     "3. low": "133.2300",
                        //     "4. close": "134.4400",
                        //     "5. volume": "2925238"
                        // },
                        // "2023-07-10": {
                        //     "1. open": "131.7600",
                        //     "2. high": "133.0500",
                        //     "3. low": "131.6950",
                        //     "4. close": "132.9000",
                        //     "5. volume": "2369425"
                        // },
                        // "2023-07-07": {
                        //     "1. open": "131.7800",
                        //     "2. high": "133.8550",
                        //     "3. low": "131.7500",
                        //     "4. close": "132.0800",
                        //     "5. volume": "2982738"
                        // },
                        // "2023-07-06": {
                        //     "1. open": "133.2350",
                        //     "2. high": "133.9000",
                        //     "3. low": "131.5500",
                        //     "4. close": "132.1600",
                        //     "5. volume": "3508083"
                        // },
                        // "2023-07-05": {
                        //     "1. open": "133.3200",
                        //     "2. high": "134.3100",
                        //     "3. low": "132.5900",
                        //     "4. close": "134.2400",
                        //     "5. volume": "2955870"
                        // },
                        // "2023-07-03": {
                        //     "1. open": "133.4200",
                        //     "2. high": "134.3500",
                        //     "3. low": "132.8700",
                        //     "4. close": "133.6700",
                        //     "5. volume": "1477149"
                        // },
                        // "2023-06-30": {
                        //     "1. open": "134.6900",
                        //     "2. high": "135.0300",
                        //     "3. low": "133.4250",
                        //     "4. close": "133.8100",
                        //     "5. volume": "4236677"
                        // },
                        // "2023-06-29": {
                        //     "1. open": "131.7500",
                        //     "2. high": "134.3500",
                        //     "3. low": "131.6900",
                        //     "4. close": "134.0600",
                        //     "5. volume": "3639836"
                        // },
                        // "2023-06-28": {
                        //     "1. open": "132.0600",
                        //     "2. high": "132.1700",
                        //     "3. low": "130.9100",
                        //     "4. close": "131.7600",
                        //     "5. volume": "2753779"
                        // },
                        // "2023-06-27": {
                        //     "1. open": "131.3000",
                        //     "2. high": "132.9500",
                        //     "3. low": "130.8300",
                        //     "4. close": "132.3400",
                        //     "5. volume": "3219909"
                        // },
                        // "2023-06-26": {
                        //     "1. open": "129.3900",
                        //     "2. high": "131.4100",
                        //     "3. low": "129.3100",
                        //     "4. close": "131.3400",
                        //     "5. volume": "4845649"
                        // },
                        // "2023-06-23": {
                        //     "1. open": "130.4000",
                        //     "2. high": "130.6200",
                        //     "3. low": "129.1800",
                        //     "4. close": "129.4300",
                        //     "5. volume": "11324705"
                        // },
                        // "2023-06-22": {
                        //     "1. open": "131.6800",
                        //     "2. high": "132.9600",
                        //     "3. low": "130.6800",
                        //     "4. close": "131.1700",
                        //     "5. volume": "6013021"
                        // },
                        // "2023-06-21": {
                        //     "1. open": "135.1100",
                        //     "2. high": "135.3900",
                        //     "3. low": "133.2900",
                        //     "4. close": "133.6900",
                        //     "5. volume": "5501272"
                        // },
                        // "2023-06-20": {
                        //     "1. open": "136.3600",
                        //     "2. high": "137.2300",
                        //     "3. low": "135.8900",
                        //     "4. close": "135.9600",
                        //     "5. volume": "4272511"
                        // },
                        // "2023-06-16": {
                        //     "1. open": "139.2300",
                        //     "2. high": "139.4690",
                        //     "3. low": "137.4700",
                        //     "4. close": "137.4800",
                        //     "5. volume": "7473676"
                        // },
                        // "2023-06-15": {
                        //     "1. open": "137.2700",
                        //     "2. high": "138.8000",
                        //     "3. low": "137.1750",
                        //     "4. close": "138.4000",
                        //     "5. volume": "3812582"
                        // },
                        // "2023-06-14": {
                        //     "1. open": "137.8000",
                        //     "2. high": "138.9300",
                        //     "3. low": "136.9400",
                        //     "4. close": "137.2000",
                        //     "5. volume": "4514888"
                        // },
                        // "2023-06-13": {
                        //     "1. open": "136.5100",
                        //     "2. high": "138.1700",
                        //     "3. low": "136.0000",
                        //     "4. close": "137.6000",
                        //     "5. volume": "3927331"
                        // },
                        // "2023-06-12": {
                        //     "1. open": "136.0000",
                        //     "2. high": "136.6200",
                        //     "3. low": "135.8216",
                        //     "4. close": "136.4200",
                        //     "5. volume": "4500120"
                        // },
                        // "2023-06-09": {
                        //     "1. open": "134.3600",
                        //     "2. high": "136.1000",
                        //     "3. low": "134.1700",
                        //     "4. close": "135.3000",
                        //     "5. volume": "3981748"
                        // },
                        // "2023-06-08": {
                        //     "1. open": "134.6900",
                        //     "2. high": "135.9800",
                        //     "3. low": "134.0100",
                        //     "4. close": "134.4100",
                        //     "5. volume": "4128939"
                        // },
                        // "2023-06-07": {
                        //     "1. open": "132.5000",
                        //     "2. high": "134.4400",
                        //     "3. low": "132.1900",
                        //     "4. close": "134.3800",
                        //     "5. volume": "5772024"
                        // },
                        // "2023-06-06": {
                        //     "1. open": "132.4300",
                        //     "2. high": "132.9400",
                        //     "3. low": "131.8800",
                        //     "4. close": "132.6900",
                        //     "5. volume": "3297951"
                        // },
                        // "2023-06-05": {
                        //     "1. open": "133.1200",
                        //     "2. high": "133.5800",
                        //     "3. low": "132.2700",
                        //     "4. close": "132.6400",
                        //     "5. volume": "3993516"
                        // },
                        // "2023-06-02": {
                        //     "1. open": "130.3800",
                        //     "2. high": "133.1200",
                        //     "3. low": "130.1500",
                        //     "4. close": "132.4200",
                        //     "5. volume": "5375796"
                        // },
                        // "2023-06-01": {
                        //     "1. open": "128.4400",
                        //     "2. high": "130.1450",
                        //     "3. low": "127.7800",
                        //     "4. close": "129.8200",
                        //     "5. volume": "4136086"
                        // },
                        // "2023-05-31": {
                        //     "1. open": "128.5100",
                        //     "2. high": "129.4400",
                        //     "3. low": "127.4600",
                        //     "4. close": "128.5900",
                        //     "5. volume": "11086313"
                        // }
                        // }

                        if(this.selectedPeriod === 'daily'){
                            timeSeriesData = data['Time Series (Daily)'];
                        }else if(this.selectedPeriod === 'hourly'){
                            timeSeriesData = data['Time Series (60min)'];
                        }
                    
                        // Once the data is fetched, set showChart to true to display the chart
                        this.showChart = true;

                        this.mountChart(timeSeriesData); // Call the mountChart method with the formatted chart data
                    
                })
                .catch(error => {
                    this.error = error.message;
                    this.errorMessage = "Not valid symbol name";
                    this.clearChartContainer();
                });
            }
        },
        mountChart(timeSeriesData) {

            const chartDiv = document.getElementById('container');
            const chartOptions = { layout: { textColor: 'black', background: { type: 'solid', color: 'white' } } };
                
            const chart = createChart(chartDiv, chartOptions);

            window.onresize = function() {
                chart.applyOptions({ 
                    width: chartDiv.offsetWidth, 
                    height: chartDiv.offsetHeight ,
                    handleScroll: true,
                    handleScale: true
                });
            }

            const candlestickSeries = chart.addCandlestickSeries({
                upColor: '#26a69a', downColor: '#ef5350', borderVisible: false,
                wickUpColor: '#26a69a', wickDownColor: '#ef5350',
            });

            const data = Object.keys(timeSeriesData).map(date => {
                const item = timeSeriesData[date];
                const formattedDate = new Date(date).getTime()/1000; // Convert date to UNIX timestamp

                return {
                time: formattedDate,
                open: parseFloat(item['1. open']),
                high: parseFloat(item['2. high']),
                low: parseFloat(item['3. low']),
                close: parseFloat(item['4. close']),
                volume: parseFloat(item['5. volume'])
                };
        
            });

            const sortedData = data.sort((a, b) => a.time - b.time);

            candlestickSeries.setData(sortedData);

            const timeScale = chart.timeScale();

            timeScale.applyOptions({
                borderColor: "#71649C",
                barSpacing: 15,
                minBarSpacing: 5,
                fixLeftEdge: true,
                fixRightEdge: true
            })

            timeScale.setVisibleRange({ from: sortedData[0].time, to: sortedData[99].time });

        }
    }
}
</script>


<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
/* new css for styling */

.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding-top: 25px;
}

.title-container {
  background-color: green;
}
.title {
  text-align: left;
  font-size: calc(1.2rem + 0.5vw);
  margin: 0;
  padding: 15px 30px;
}
.box {
  display: flex;
  gap: 30px;
  margin: 20px auto 10px auto;
  justify-content: center;
}

.error-msg {
    text-align: left;
    color: red;
    font-size: 12px;
    margin-top: 5px;
}

.symbol-input {
  outline: none !important;
  box-shadow: none !important;
  height: 30px;
  border: 1px solid lightgreen;
  font-size: 16px;
  padding-left: 8px;
  border-radius: 5px;
}

select{
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    height: 33px !important;
    width: 150px;
    cursor: pointer;
    background-color: #fff;
    color: grey;
    background-image: url("arrow-down.png");
    background-repeat: no-repeat;
    background-size: 30px;
    background-position: right center;
    outline: none !important;
    border: 1px solid lightgreen;
    font-size: 16px;
    padding-left: 8px;
    border-radius: 5px;
    box-shadow: 0 0 20px rgba(20,20,30,0.25);
}
select::-ms-expand{
    display: none;
}

select option:hover {
    background-color: transparent; /* Set the background color to transparent */
}
select option{
    border: 1px solid lightgray;
    letter-spacing: 1.2px;
    font-weight: 400;
    font-size: 16px;
    padding: 10px 20px;
}
/* For Firefox */
select option:checked {
    background-color: initial; /* Set the background color to initial */
}
.selected{
    display: none;
}

.fetch-btn {
  outline: none !important;
  box-shadow: none !important;
  border: none;
  padding: 10px 15px;
  color: #fff;
  border-radius: 5px;
  margin: 20px 10px;
  font-size: 16px;
  letter-spacing: 0.5px;
  font-weight: 600;
}

.chart {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 20px;
}

.loader {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #3498db;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 2s linear infinite;
    margin: 20px auto;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

/* Mobile Styles */
@media (max-width: 450px) {
  .container {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
    margin: 10px;
    padding-top: 10px;
  }

  .title {
    padding: 15px;
  }
  .box {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: 30px;
  }
  .symbol-input{
    width: 100%;
  }

  .dropdown-wrapper {
    width: 80%;
    display: flex;
    justify-content: center;
    align-items: flex-start;
  }

  select {
    width: 100%;
  }
  .fetch-btn {
    margin: 0px;
    margin-top: 20px;
  }
  .chart {
    margin-top: 20px;
  }

}

</style>
